<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Quinoa: /tmp/q/quinoa/src/Inciter/Carrier.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Documents</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_carrier_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<div class="title">Carrier.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Carrier advances a system of transport equations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;array&gt;</code><br />
<code>#include &lt;cstddef&gt;</code><br />
<code>#include &lt;iosfwd&gt;</code><br />
<code>#include &lt;utility&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;cstring&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;unordered_map&gt;</code><br />
<code>#include &lt;set&gt;</code><br />
<code>#include &quot;Types.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_fields_8h_source.html">Fields.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_particles_8h_source.html">Particles.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_derived_data_8h_source.html">DerivedData.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_vector_reducer_8h_source.html">VectorReducer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_fields_merger_8h_source.html">FieldsMerger.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_inciter_2_input_deck_2_input_deck_8h_source.html">Inciter/InputDeck/InputDeck.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="transporter_8decl_8h_source.html">NoWarning/transporter.decl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="carrier_8decl_8h_source.html">NoWarning/carrier.decl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="particlewriter_8decl_8h_source.html">NoWarning/particlewriter.decl.h</a>&quot;</code><br />
</div>
<p><a href="_carrier_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_carrier.html">inciter::Carrier</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classinciter_1_1_carrier.html" title="Carrier Charm++ chare array used to advance transport equations in time. ">Carrier</a> Charm++ chare array used to advance transport equations in time.  <a href="classinciter_1_1_carrier.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacetk"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetk.html">tk</a></td></tr>
<tr class="memdesc:namespacetk"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toolkit declarations and definitions for general purpose utilities. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceinciter"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceinciter.html">inciter</a></td></tr>
<tr class="memdesc:namespaceinciter"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inciter declarations and definitions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Carrier advances a system of transport equations. </p>
<dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Thu 22 Sep 2016 10:08:22 AM MDT </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2012-2015, Jozsef Bakosi, 2016, Los Alamos National Security, LLC.</dd></dl>
<p>Carrier advances a system of transport equations. There are a potentially large number of Carrier Charm++ chares created by Transporter. Each carrier gets a chunk of the full load (part of the mesh) and does the same: initializes and advances a system of systems of PDEs in time.</p>
<p>The implementation uses the Charm++ runtime system and is fully asynchronous, overlapping computation and communication. The algorithm utilizes the structured dagger (SDAG) Charm++ functionality. The high-level overview of the algorithm structure and how it interfaces with Charm++ is discussed in the Charm++ interface file <a class="el" href="carrier_8ci.html">src/Inciter/carrier.ci</a>.</p>
<h4>Call graph</h4>
<p>The following is a directed acyclic graph (DAG) that outlines the asynchronous algorithm implemented in this class The detailed discussion of the algorithm is given in the Charm++ interface file <a class="el" href="transporter_8ci.html">transporter.ci</a>, which also repeats the graph below using ASCII graphics. On the DAG orange fills denote global synchronization points that contain or eventually lead to global reductions. Dashed lines are potential shortcuts that allow jumping over some of the task-graph under some circumstances or optional code paths (taken, e.g., only in DEBUG mode). See the detailed discussion in <a class="el" href="carrier_8ci.html">carrier.ci</a>. </p><div align="center">
<iframe scrolling="no" frameborder="0" src="dot_inline_dotgraph_1.svg" width="203" height="280"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
 <div class="fragment"><div class="line">// *****************************************************************************</div><div class="line">/*!</div><div class="line">  \file      src/Inciter/carrier.ci</div><div class="line">  \author    J. Bakosi</div><div class="line">  \date      Tue 20 Sep 2016 03:33:36 PM MDT</div><div class="line">  \copyright 2012-2015, Jozsef Bakosi, 2016, Los Alamos National Security, LLC.</div><div class="line">  \brief     Charm++ module interface file for Carrier</div><div class="line">  \details   Charm++ module interface file for Carrier</div><div class="line">*/</div><div class="line">// *****************************************************************************</div><div class="line"></div><div class="line">module carrier {</div><div class="line"></div><div class="line">  extern module transporter;</div><div class="line">  extern module linsysmerger;</div><div class="line">  extern module particlewriter;</div><div class="line"></div><div class="line">  include &quot;Particles.h&quot;;</div><div class="line"></div><div class="line">  namespace inciter {</div><div class="line"></div><div class="line">    array [1D] Carrier {</div><div class="line">      entry</div><div class="line">        Carrier( const CProxy_Transporter&amp; transporter,</div><div class="line">                 const tk::CProxy_LinSysMerger&lt; CProxy_Transporter,</div><div class="line">                                                CProxy_Carrier &gt;&amp; lsm,</div><div class="line">                 const tk::CProxy_ParticleWriter&lt; CProxy_Transporter &gt;&amp; pw,</div><div class="line">                 const std::vector&lt; std::size_t &gt;&amp; conn,</div><div class="line">                 const std::unordered_map&lt; std::size_t, std::size_t &gt;&amp; cid,</div><div class="line">                 int ncarr );</div><div class="line">      initnode void registerReducers();</div><div class="line">      entry void comm();</div><div class="line">      entry [reductiontarget] void msum( CkReductionMsg* msg );</div><div class="line">      entry void setup();</div><div class="line">      entry void requestBCs();</div><div class="line">      entry void oldID( int frompe, const std::vector&lt; std::size_t &gt;&amp; newids );</div><div class="line">      entry void bcval( int frompe, const std::vector&lt; std::size_t &gt;&amp; nodes );</div><div class="line">      entry void init( tk::real dt );</div><div class="line">      entry void updateHighSol( const std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line">                                const std::vector&lt; tk::real &gt;&amp; sol );</div><div class="line">      entry void updateLowSol( const std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line">                               const std::vector&lt; tk::real &gt;&amp; sol );</div><div class="line">      entry void advance( uint8_t stage, tk::real dt, uint64_t it, tk::real t );</div><div class="line">      entry void findpar( int fromch,</div><div class="line">                          const std::vector&lt; std::size_t &gt;&amp; miss,</div><div class="line">                          const tk::Particles&amp; ps );</div><div class="line">      entry void foundpar( const std::vector&lt; std::size_t &gt;&amp; found );</div><div class="line">      entry void collectpar( int fromch,</div><div class="line">                             const std::vector&lt; std::size_t &gt;&amp; miss,</div><div class="line">                             const tk::Particles&amp; ps );</div><div class="line">      entry void collectedpar( const std::vector&lt; std::size_t &gt;&amp; found );</div><div class="line">      entry void out();</div><div class="line">      entry void doWriteParticles();</div><div class="line">      entry void finishaec( const std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line">                            const std::vector&lt; std::vector&lt; tk::real &gt; &gt;&amp; P );</div><div class="line">      entry void finishalw( const std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line">                            const std::vector&lt; std::vector&lt; tk::real &gt; &gt;&amp; Q );</div><div class="line">      entry void finishlim( const std::vector&lt; std::size_t &gt;&amp; gid,</div><div class="line">                            const std::vector&lt; std::vector&lt; tk::real &gt; &gt;&amp; U );</div><div class="line">      entry void limit();</div><div class="line">      entry void eval();</div><div class="line"></div><div class="line">      // SDAG code follows. See http://charm.cs.illinois.edu/manuals/html/</div><div class="line">      // charm++/manual.html, Sec. &quot;Structured Control Flow: Structured Dagger&quot;.</div><div class="line"></div><div class="line">      // High-level overview of the dependency and asynchronous call structure</div><div class="line">      // ---------------------------------------------------------------------</div><div class="line">      //</div><div class="line">      // Directed Acyclic Graph (DAG):</div><div class="line">      // -----------------------------</div><div class="line">      //                         DAG legend:</div><div class="line">      //  Hi --- Ver               AEC - communication of antidiffusive element</div><div class="line">      //        /                        contributions complete</div><div class="line">      //  Lo --                    ALW - communication of maximum and minimum</div><div class="line">      //                                 unknowns of elements surrounding nodes</div><div class="line">      //                                 complete</div><div class="line">      //  AEC --- Limit            Hi  - High order solution updated</div><div class="line">      //         /                 Lo  - Low order solution updated</div><div class="line">      //  ALW --                   Limit - Perform limiting as the final step of</div><div class="line">      //                                   flux-corrected transport</div><div class="line">      //                           Ver - Verification of antidiffusive element</div><div class="line">      //                                 contributions</div><div class="line">      //</div><div class="line">      //</div><div class="line">      // Interpretation of the above DAG</div><div class="line">      // -------------------------------</div><div class="line">      // Control flow is from left to right and top to bottom.</div><div class="line">      //</div><div class="line">      // Only if both the high and low order solution updates have been received</div><div class="line">      // can verification of the antidiffusive element contributions can be</div><div class="line">      // performed. Note that this code path does not continue anywhere else and</div><div class="line">      // it only runs code if the number Carrier chares is one. See</div><div class="line">      // FluxCorrector::verify() for more details.</div><div class="line">      //</div><div class="line">      // Only if both the communication of antidiffusive element contributions</div><div class="line">      // (AEC) and the communication of the maximum and minimum unknowns of</div><div class="line">      // elements surrounding nodes (ALW) have been completed, can limiting be</div><div class="line">      // performed.</div><div class="line">      //</div><div class="line">      // Note that the global reduction to host (Transporter) in wait4fct()</div><div class="line">      // ensures that all arrays necessary for doing limiting (P,Q,Ul) have been</div><div class="line">      // updated across all chares.</div><div class="line"></div><div class="line">      entry void wait4sol() {</div><div class="line">        when hi_complete(), lo_complete() serial &quot;sol&quot; { verify(); } };</div><div class="line"></div><div class="line">      entry void wait4fct() {</div><div class="line">        when aec_complete(), alw_complete() serial &quot;fct&quot; {</div><div class="line">          contribute( CkCallback( CkReductionTarget( Transporter, limit ),</div><div class="line">                                  m_transporter ) ); } };</div><div class="line"></div><div class="line">      entry void hi_complete();</div><div class="line">      entry void lo_complete();</div><div class="line">      entry void aec_complete();</div><div class="line">      entry void alw_complete();</div><div class="line">    };</div><div class="line"></div><div class="line">  } // inciter::</div><div class="line"></div><div class="line">}</div></div><!-- fragment --> 
<p>Definition in file <a class="el" href="_carrier_8h_source.html">Carrier.h</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_606df7a4664720c111e6e5b0e11c4e03.html">Inciter</a></li><li class="navelem"><a class="el" href="_carrier_8h.html">Carrier.h</a></li>
    <li class="footer">Generated on Sun Sep 25 2016 04:38:19 for Quinoa by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
