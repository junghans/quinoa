<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Quinoa: inciter::FluxCorrector Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quinoa.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quinoa
   </div>
   <div id="projectbrief">Adaptive computational fluid dynamics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Documents</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classinciter_1_1_flux_corrector.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classinciter_1_1_flux_corrector-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">inciter::FluxCorrector Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a260166f8f83463a9b99c260d525ef8cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a260166f8f83463a9b99c260d525ef8cd">FluxCorrector</a> (std::size_t is=0)</td></tr>
<tr class="separator:a260166f8f83463a9b99c260d525ef8cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99b542f5fbfa56f7df980d22cdbae35c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a99b542f5fbfa56f7df980d22cdbae35c">aec</a> (const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, const std::vector&lt; std::size_t &gt; &amp;inpoel, const std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &amp;vol, const tk::Fields &amp;dUh, const tk::Fields &amp;Un, tk::Fields &amp;P)</td></tr>
<tr class="memdesc:a99b542f5fbfa56f7df980d22cdbae35c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute antidiffusive element contributions (AEC)  <a href="#a99b542f5fbfa56f7df980d22cdbae35c">More...</a><br /></td></tr>
<tr class="separator:a99b542f5fbfa56f7df980d22cdbae35c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c1ccc3be523b160364780732f780230"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a6c1ccc3be523b160364780732f780230">verify</a> (std::size_t nchare, const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::Fields &amp;dUh, const tk::Fields &amp;dUl) const </td></tr>
<tr class="memdesc:a6c1ccc3be523b160364780732f780230"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify the assembled antidiffusive element contributions.  <a href="#a6c1ccc3be523b160364780732f780230">More...</a><br /></td></tr>
<tr class="separator:a6c1ccc3be523b160364780732f780230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a12b63e7d9a0ecd8baaf4d102746919"><td class="memItemLeft" align="right" valign="top">tk::Fields&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a7a12b63e7d9a0ecd8baaf4d102746919">lump</a> (const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, const std::vector&lt; std::size_t &gt; &amp;inpoel) const </td></tr>
<tr class="memdesc:a7a12b63e7d9a0ecd8baaf4d102746919"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute lumped mass matrix lhs for low order system.  <a href="#a7a12b63e7d9a0ecd8baaf4d102746919">More...</a><br /></td></tr>
<tr class="separator:a7a12b63e7d9a0ecd8baaf4d102746919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7718ab811b6e72b5878c72f86e068b5"><td class="memItemLeft" align="right" valign="top">tk::Fields&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#ab7718ab811b6e72b5878c72f86e068b5">diff</a> (const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;coord, const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::Fields &amp;Un) const </td></tr>
<tr class="memdesc:ab7718ab811b6e72b5878c72f86e068b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute mass diffusion contribution to the rhs of the low order system.  <a href="#ab7718ab811b6e72b5878c72f86e068b5">More...</a><br /></td></tr>
<tr class="separator:ab7718ab811b6e72b5878c72f86e068b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaf830c9b5f66e2a8be7c008bb77484b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#aaaf830c9b5f66e2a8be7c008bb77484b">alw</a> (const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::Fields &amp;Un, const tk::Fields &amp;Ul, tk::Fields &amp;Q) const </td></tr>
<tr class="memdesc:aaaf830c9b5f66e2a8be7c008bb77484b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the maximum and minimum unknowns of all elements surrounding nodes.  <a href="#aaaf830c9b5f66e2a8be7c008bb77484b">More...</a><br /></td></tr>
<tr class="separator:aaaf830c9b5f66e2a8be7c008bb77484b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad43e70b5ccda36f0d541e674404236ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#ad43e70b5ccda36f0d541e674404236ed">lim</a> (const std::vector&lt; std::size_t &gt; &amp;inpoel, const tk::Fields &amp;P, const tk::Fields &amp;Ul, tk::Fields &amp;Q, tk::Fields &amp;A) const </td></tr>
<tr class="memdesc:ad43e70b5ccda36f0d541e674404236ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute limited antiffusive element contributions and apply to mesh nodes.  <a href="#ad43e70b5ccda36f0d541e674404236ed">More...</a><br /></td></tr>
<tr class="separator:ad43e70b5ccda36f0d541e674404236ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a1281f06d84581b1b5a527a8ad975c2f4"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> = kw::ncomp::info::expect::type</td></tr>
<tr class="separator:a1281f06d84581b1b5a527a8ad975c2f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a5ed244339a9816df09d82a4ce620b5dd"><td class="memItemLeft" align="right" valign="top">tk::Fields&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a></td></tr>
<tr class="memdesc:a5ed244339a9816df09d82a4ce620b5dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Antidiffusive element contributions for all scalar components.  <a href="#a5ed244339a9816df09d82a4ce620b5dd">More...</a><br /></td></tr>
<tr class="separator:a5ed244339a9816df09d82a4ce620b5dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63a87d4dff620c6f905f0403ed0b1764"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a63a87d4dff620c6f905f0403ed0b1764">pup</a> (PUP::er &amp;p)</td></tr>
<tr class="memdesc:a63a87d4dff620c6f905f0403ed0b1764"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack/Unpack serialize member function.  <a href="#a63a87d4dff620c6f905f0403ed0b1764">More...</a><br /></td></tr>
<tr class="separator:a63a87d4dff620c6f905f0403ed0b1764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a6560d181de19a2239836c77efc2353"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classinciter_1_1_flux_corrector.html#a3a6560d181de19a2239836c77efc2353">operator|</a> (PUP::er &amp;p, <a class="el" href="classinciter_1_1_flux_corrector.html">FluxCorrector</a> &amp;i)</td></tr>
<tr class="memdesc:a3a6560d181de19a2239836c77efc2353"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack/Unpack serialize operator|.  <a href="#a3a6560d181de19a2239836c77efc2353">More...</a><br /></td></tr>
<tr class="separator:a3a6560d181de19a2239836c77efc2353"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classinciter_1_1_flux_corrector.html">FluxCorrector</a> is used to perform flux-corrected transport </p><dl class="section see"><dt>See also</dt><dd>Löhner, R., Morgan, K., Peraire, J. and Vahdati, M. (1987), Finite element flux-corrected transport (FEM–FCT) for the Euler and Navier–Stokes equations. Int. J. Numer. Meth. Fluids, 7: 1093–1109. doi:10.1002/fld.1650071007 </dd></dl>

<p>Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00034">34</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a1281f06d84581b1b5a527a8ad975c2f4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a> =  kw::ncomp::info::expect::type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00093">93</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a260166f8f83463a9b99c260d525ef8cd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">inciter::FluxCorrector::FluxCorrector </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>is</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">is</td><td>Size of the mesh element connectivity vector (inpoel size) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00039">39</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>

<p>References <a class="el" href="_flux_corrector_8_c_source.html#l00027">aec()</a>, <a class="el" href="_flux_corrector_8_c_source.html#l00293">alw()</a>, <a class="el" href="_flux_corrector_8_c_source.html#l00235">diff()</a>, <a class="el" href="_flux_corrector_8_c_source.html#l00344">lim()</a>, <a class="el" href="_flux_corrector_8_c_source.html#l00192">lump()</a>, and <a class="el" href="_flux_corrector_8_c_source.html#l00131">verify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                               :</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>( is, <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop() ) {}</div><div class="ttc" id="classinciter_1_1_flux_corrector_html_a5ed244339a9816df09d82a4ce620b5dd"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">inciter::FluxCorrector::m_aec</a></div><div class="ttdeci">tk::Fields m_aec</div><div class="ttdoc">Antidiffusive element contributions for all scalar components. </div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00096">FluxCorrector.h:96</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00049">Control.h:49</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00118">Tags.h:118</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_carrier_8_c_source.html#l00043">Carrier.C:43</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_a260166f8f83463a9b99c260d525ef8cd_cgraph.svg" width="100%" height="564"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a99b542f5fbfa56f7df980d22cdbae35c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FluxCorrector::aec </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>dUh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Un</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>P</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute antidiffusive element contributions (AEC) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coord</td><td>Mesh node coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vol</td><td>Volume associated to mesh nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dUh</td><td>Increment of the high order solution </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Un</td><td>Solution at the previous time step stage </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">P</td><td>The sums of positive (negative) AECs to nodes</td></tr>
  </table>
  </dd>
</dl>
<p>The antidiffusive element contributions (AEC) are computed as the difference between the high and low order solution, where the high order solution is consistent mass Taylor-Galerkin and the low order solution is lumped mass Taylor-Galerkin + diffusion. Note that AEC is not directly computed as dUh - dUl (although that could also be done), but as AEC = M_L^{-1} (M_Le - M_ce) (ctau * Un + dUh), where</p><ul>
<li>M_ce is the element's consistent mass matrix,</li>
<li>M_Le is the element's lumped mass matrix,</li>
<li>ctau is the mass diffusion coefficient on the rhs of the low order solution, see also <a class="el" href="classinciter_1_1_flux_corrector.html#ab7718ab811b6e72b5878c72f86e068b5" title="Compute mass diffusion contribution to the rhs of the low order system. ">FluxCorrector::diff()</a>,</li>
<li>Un is the solution at the previous time step stage,</li>
<li>dUh is the increment of the high order solution, and</li>
<li>M_L^{-1} is the inverse of the assembled lumped mass matrix, i.e., the volume associated to a mesh node by summing the quarter of the element volumes surrounding the node. Note this is the correct node volume taking into account that some nodes are on chare boundaries. See <a class="el" href="classinciter_1_1_carrier.html#a8f018070e7fc8f318a71d011a2b33ace" title="Starts collecting global mesh node IDs bordering the mesh chunk held by fellow Carrier chares associa...">Carrier::comm()</a>. <dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>
</li>
</ul>

<p>Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00027">27</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_carrier_8_c_source.html#l00043">inciter::g_inputdeck</a>, <a class="el" href="_derived_data_8_c_source.html#l00026">tk::genEsup()</a>, <a class="el" href="_control_8h_source.html#l00049">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_flux_corrector_8h_source.html#l00096">m_aec</a>, <a class="el" href="_data_8h_source.html#l00581">tk::max()</a>, <a class="el" href="_data_8h_source.html#l00561">tk::min()</a>, and <a class="el" href="_vector_8h_source.html#l00067">tk::triple()</a>.</p>

<p>Referenced by <a class="el" href="_carrier_8_c_source.html#l00699">inciter::Carrier::aec()</a>, and <a class="el" href="_flux_corrector_8h_source.html#l00039">FluxCorrector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keyword">auto</span> ctau = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1discr.html">tag::discr</a>, <a class="code" href="structtag_1_1ctau.html">tag::ctau</a> &gt;();</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( vol.size() == coord[0].size(), <span class="stringliteral">&quot;Nodal volume vector size mismatch&quot;</span> );</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>.nunk() == inpoel.size() &amp;&amp; <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>.nprop() == ncomp,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          <span class="stringliteral">&quot;AEC and mesh connectivity size mismatch&quot;</span> );</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( Un.nunk() == dUh.nunk() &amp;&amp; Un.nprop() == dUh.nprop(),</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          <span class="stringliteral">&quot;Unknown array size mismatch&quot;</span> );</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( P.nunk() == dUh.nunk() &amp;&amp; P.nprop() == dUh.nprop()*2,</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          <span class="stringliteral">&quot;Sums of positive (negative) AECs to nodes array size mismatch&quot;</span> );</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; x = coord[0];</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; y = coord[1];</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z = coord[2];</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>.fill( 0.0 );</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// compute element Jacobi determinant</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">const</span> std::array&lt; tk::real, 3 &gt;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      ba{{ x[N[1]]-x[N[0]], y[N[1]]-y[N[0]], z[N[1]]-z[N[0]] }},</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      ca{{ x[N[2]]-x[N[0]], y[N[2]]-y[N[0]], z[N[2]]-z[N[0]] }},</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      da{{ x[N[3]]-x[N[0]], y[N[3]]-y[N[0]], z[N[3]]-z[N[0]] }};</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> J = <a class="code" href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a>( ba, ca, da );</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// lumped - consistent mass</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    std::array&lt; std::array&lt; tk::real, 4 &gt;, 4 &gt; m;       <span class="comment">// nnode*nnode [4][4]</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    m[0][0] = m[1][1] = m[2][2] = m[3][3] = 3.0*J/120.0;<span class="comment">// diagonal</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    m[0][1] = m[0][2] = m[0][3] =                       <span class="comment">// off-diagonal</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    m[1][0] = m[1][2] = m[1][3] =</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    m[2][0] = m[2][1] = m[2][3] =</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    m[3][0] = m[3][1] = m[3][2] = -J/120.0;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// access solution at element nodes at time n</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    std::vector&lt; std::array&lt; tk::real, 4 &gt; &gt; un( ncomp );</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) un[c] = Un.extract( c, 0, N );</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// access high-order solution increment at element nodes</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    std::vector&lt; std::array&lt; tk::real, 4 &gt; &gt; duh( ncomp );</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) duh[c] = dUh.extract( c, 0, N );</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// compute antidiffusive element contributions</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">for</span> (std::size_t k=0; k&lt;4; ++k)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+j,c,0) += m[j][k] * (ctau*un[c][k] + duh[c][k]) / vol[N[j]];</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="comment">// sum all positive (negative) antidiffusive element contributions to nodes</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// (Lohner: P^{+,-}_i)</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> esup = <a class="code" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a>( inpoel, 4 );</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">for</span> (std::size_t p=0; p&lt;dUh.nunk(); ++p)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> i=esup.second[p]+1; i&lt;=esup.second[p+1]; ++i) {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;       <span class="keyword">const</span> <span class="keyword">auto</span> e = esup.first[i];</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;       <span class="comment">// decide which node&#39;s contribution we need (A, B, C, or D)</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;       std::size_t n = 3;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span> (inpoel[e*4+0] == p) n = 0;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inpoel[e*4+1] == p) n = 1;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inpoel[e*4+2] == p) n = 2;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;       <span class="comment">// add up element contributions to node p</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;       <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;         P(p,c*2+0,0) += <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::max</a>( 0.0, <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+n,c,0) );</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;         P(p,c*2+1,0) += <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>( 0.0, <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+n,c,0) );</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;       }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div><div class="ttc" id="namespacetk_html_afd730d099e698f124362ef8c01483e0f"><div class="ttname"><a href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">tk::min</a></div><div class="ttdeci">Data&lt; Layout &gt; min(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00561">Data.h:561</a></div></div>
<div class="ttc" id="structtag_1_1discr_html"><div class="ttname"><a href="structtag_1_1discr.html">tag::discr</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00117">Tags.h:117</a></div></div>
<div class="ttc" id="structtag_1_1ctau_html"><div class="ttname"><a href="structtag_1_1ctau.html">tag::ctau</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00069">Tags.h:69</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a5ed244339a9816df09d82a4ce620b5dd"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">inciter::FluxCorrector::m_aec</a></div><div class="ttdeci">tk::Fields m_aec</div><div class="ttdoc">Antidiffusive element contributions for all scalar components. </div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00096">FluxCorrector.h:96</a></div></div>
<div class="ttc" id="namespacetk_html_a66a2889d5d8aeb4a836842c6a1010463"><div class="ttname"><a href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genEsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe)</div><div class="ttdoc">Generate derived data structure, elements surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00026">DerivedData.C:26</a></div></div>
<div class="ttc" id="namespacetk_html_ae5b04b00aa51667b944b7188545ec5ae"><div class="ttname"><a href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a></div><div class="ttdeci">T triple(const std::array&lt; T, 3 &gt; &amp;v1, const std::array&lt; T, 3 &gt; &amp;v2, const std::array&lt; T, 3 &gt; &amp;v3)</div><div class="ttdef"><b>Definition:</b> <a href="_vector_8h_source.html#l00067">Vector.h:67</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00093">FluxCorrector.h:93</a></div></div>
<div class="ttc" id="namespacetk_html_ac9a26e30d19b940a12990a866a514cb5"><div class="ttname"><a href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">tk::max</a></div><div class="ttdeci">Data&lt; Layout &gt; max(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00581">Data.h:581</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00049">Control.h:49</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00118">Tags.h:118</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00049">Exception.h:49</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_carrier_8_c_source.html#l00043">Carrier.C:43</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_a99b542f5fbfa56f7df980d22cdbae35c_cgraph.svg" width="523" height="283"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaaf830c9b5f66e2a8be7c008bb77484b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FluxCorrector::alw </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Un</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Ul</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the maximum and minimum unknowns of all elements surrounding nodes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Un</td><td>Solution at the previous time step stage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Ul</td><td>Low order solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Q</td><td>Maximum and mimimum unknowns of elements surrounding nodes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00293">293</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_carrier_8_c_source.html#l00043">inciter::g_inputdeck</a>, <a class="el" href="_derived_data_8_c_source.html#l00026">tk::genEsup()</a>, <a class="el" href="_control_8h_source.html#l00049">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_data_8h_source.html#l00581">tk::max()</a>, and <a class="el" href="_data_8h_source.html#l00561">tk::min()</a>.</p>

<p>Referenced by <a class="el" href="_carrier_8_c_source.html#l00761">inciter::Carrier::alw()</a>, and <a class="el" href="_flux_corrector_8h_source.html#l00039">FluxCorrector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;{</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( Q.nunk() == Un.nunk() &amp;&amp; Q.nprop() == Un.nprop()*2, <span class="stringliteral">&quot;Max and min &quot;</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <span class="stringliteral">&quot;unknowns of elements surrounding nodes array size mismatch&quot;</span> );</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">// compute maximum and minimum nodal values of Ul and Un (Lohner: u^*_i)</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keyword">auto</span> Smax = <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">tk::max</a>( Ul, Un );</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keyword">auto</span> Smin = <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">tk::min</a>( Ul, Un );</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// compute maximum and minimum nodal values of all elements (Lohner: u^*_el)</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  tk::Fields S( inpoel.size()/4, ncomp*2 );</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      S(e,c*2+0,0) = <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::max</a>( Smax(N[3],c,0),</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                       <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::max</a>( Smax(N[2],c,0),</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                         <a class="code" href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">std::max</a>( Smax(N[0],c,0), Smax(N[1],c,0) ) ) );</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      S(e,c*2+1,0) = <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>( Smin(N[3],c,0),</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                       <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>( Smin(N[2],c,0),</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                         <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>( Smin(N[0],c,0), Smin(N[1],c,0) ) ) );</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// compute maximum and mimimum unknowns of all elements surrounding each node</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// (Lohner: u^{max,min}_i)</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> esup = <a class="code" href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a>( inpoel, 4 );</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">for</span> (std::size_t p=0; p&lt;Un.nunk(); ++p)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> i=esup.second[p]+1; i&lt;=esup.second[p+1]; ++i) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> e = esup.first[i];</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">if</span> (S(e,c*2+0,0) &gt; Q(p,c*2+0,0)) Q(p,c*2+0,0) = S(e,c*2+0,0);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span> (S(e,c*2+1,0) &lt; Q(p,c*2+1,0)) Q(p,c*2+1,0) = S(e,c*2+1,0);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div><div class="ttc" id="namespacetk_html_afd730d099e698f124362ef8c01483e0f"><div class="ttname"><a href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">tk::min</a></div><div class="ttdeci">Data&lt; Layout &gt; min(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00561">Data.h:561</a></div></div>
<div class="ttc" id="namespacetk_html_a66a2889d5d8aeb4a836842c6a1010463"><div class="ttname"><a href="namespacetk.html#a66a2889d5d8aeb4a836842c6a1010463">tk::genEsup</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; std::size_t &gt;, std::vector&lt; std::size_t &gt; &gt; genEsup(const std::vector&lt; std::size_t &gt; &amp;inpoel, std::size_t nnpe)</div><div class="ttdoc">Generate derived data structure, elements surrounding points. </div><div class="ttdef"><b>Definition:</b> <a href="_derived_data_8_c_source.html#l00026">DerivedData.C:26</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00093">FluxCorrector.h:93</a></div></div>
<div class="ttc" id="namespacetk_html_ac9a26e30d19b940a12990a866a514cb5"><div class="ttname"><a href="namespacetk.html#ac9a26e30d19b940a12990a866a514cb5">tk::max</a></div><div class="ttdeci">Data&lt; Layout &gt; max(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00581">Data.h:581</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00049">Control.h:49</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00118">Tags.h:118</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00049">Exception.h:49</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_carrier_8_c_source.html#l00043">Carrier.C:43</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_aaaf830c9b5f66e2a8be7c008bb77484b_cgraph.svg" width="520" height="208"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab7718ab811b6e72b5878c72f86e068b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tk::Fields FluxCorrector::diff </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Un</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute mass diffusion contribution to the rhs of the low order system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coord</td><td>Mesh node coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Un</td><td>Solution at the previous time step stage </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Mass diffusion contribution to the RHS of the low order system </dd></dl>
<dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00235">235</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p>References <a class="el" href="_carrier_8_c_source.html#l00043">inciter::g_inputdeck</a>, <a class="el" href="_control_8h_source.html#l00049">tk::Control&lt; Ts &gt;::get()</a>, and <a class="el" href="_vector_8h_source.html#l00067">tk::triple()</a>.</p>

<p>Referenced by <a class="el" href="_flux_corrector_8h_source.html#l00039">FluxCorrector()</a>, and <a class="el" href="_carrier_8_c_source.html#l00555">inciter::Carrier::rhs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; x = coord[0];</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; y = coord[1];</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z = coord[2];</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keyword">auto</span> ctau = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1discr.html">tag::discr</a>, <a class="code" href="structtag_1_1ctau.html">tag::ctau</a> &gt;();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  tk::Fields D( Un.nunk(), Un.nprop() );</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  D.fill( 0.0 );</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// compute element Jacobi determinant</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keyword">const</span> std::array&lt; tk::real, 3 &gt;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      ba{{ x[N[1]]-x[N[0]], y[N[1]]-y[N[0]], z[N[1]]-z[N[0]] }},</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      ca{{ x[N[2]]-x[N[0]], y[N[2]]-y[N[0]], z[N[2]]-z[N[0]] }},</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      da{{ x[N[3]]-x[N[0]], y[N[3]]-y[N[0]], z[N[3]]-z[N[0]] }};</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> J = <a class="code" href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a>( ba, ca, da );</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// lumped - consistent mass</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    std::array&lt; std::array&lt; tk::real, 4 &gt;, 4 &gt; m;       <span class="comment">// nnode*nnode [4][4]</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    m[0][0] = m[1][1] = m[2][2] = m[3][3] = 3.0*J/120.0;<span class="comment">// diagonal</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    m[0][1] = m[0][2] = m[0][3] =                       <span class="comment">// off-diagonal</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    m[1][0] = m[1][2] = m[1][3] =</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    m[2][0] = m[2][1] = m[2][3] =</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    m[3][0] = m[3][1] = m[3][2] = -J/120.0;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// access solution at element nodes at time n</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    std::vector&lt; std::array&lt; tk::real, 4 &gt; &gt; un( ncomp );</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) un[c] = Un.extract( c, 0, N );</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// access pointer to mass diffusion right hand side at element nodes</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    std::vector&lt; const tk::real* &gt; d( ncomp );</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) d[c] = D.cptr( c, 0 );</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// scatter-add mass diffusion element contributions to rhs nodes</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">for</span> (std::size_t k=0; k&lt;4; ++k)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;           D.var(d[c],N[j]) -= ctau * m[j][k] * un[c][k];</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">return</span> D;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div><div class="ttc" id="structtag_1_1discr_html"><div class="ttname"><a href="structtag_1_1discr.html">tag::discr</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00117">Tags.h:117</a></div></div>
<div class="ttc" id="structtag_1_1ctau_html"><div class="ttname"><a href="structtag_1_1ctau.html">tag::ctau</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00069">Tags.h:69</a></div></div>
<div class="ttc" id="namespacetk_html_ae5b04b00aa51667b944b7188545ec5ae"><div class="ttname"><a href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a></div><div class="ttdeci">T triple(const std::array&lt; T, 3 &gt; &amp;v1, const std::array&lt; T, 3 &gt; &amp;v2, const std::array&lt; T, 3 &gt; &amp;v3)</div><div class="ttdef"><b>Definition:</b> <a href="_vector_8h_source.html#l00067">Vector.h:67</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00093">FluxCorrector.h:93</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00049">Control.h:49</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00118">Tags.h:118</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_carrier_8_c_source.html#l00043">Carrier.C:43</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_ab7718ab811b6e72b5878c72f86e068b5_cgraph.svg" width="451" height="110"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad43e70b5ccda36f0d541e674404236ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FluxCorrector::lim </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Ul</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute limited antiffusive element contributions and apply to mesh nodes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">P</td><td>The sums of all positive (negative) AECs to nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Ul</td><td>Low order solution </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Q</td><td>The maximum and mimimum unknowns of elements surrounding each node </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Limited</td><td>antidiffusive element contributions scatter-added to nodes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Q is also overwritten to avoid using temporary memory </dd></dl>
<dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00344">344</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_carrier_8_c_source.html#l00043">inciter::g_inputdeck</a>, <a class="el" href="_control_8h_source.html#l00049">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_flux_corrector_8h_source.html#l00096">m_aec</a>, and <a class="el" href="_data_8h_source.html#l00561">tk::min()</a>.</p>

<p>Referenced by <a class="el" href="_flux_corrector_8h_source.html#l00039">FluxCorrector()</a>, and <a class="el" href="_carrier_8_c_source.html#l00830">inciter::Carrier::lim()</a>.</p>
<div class="fragment"><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;{</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( P.nunk() == Q.nunk() &amp;&amp; P.nprop() == Q.nprop(), <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( P.nunk() == Ul.nunk() &amp;&amp; P.nprop() == Ul.nprop()*2, <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( A.nunk() == Ul.nunk() &amp;&amp; A.nprop() == Ul.nprop(), <span class="stringliteral">&quot;Size mismatch&quot;</span> );</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// compute the maximum and minimum increments and decrements nodal solution</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">// values are allowed to achieve (Lohner: Q^{+,-}_i)</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">for</span> (std::size_t p=0; p&lt;Ul.nunk(); ++p)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      Q(p,c*2+0,0) -= Ul(p,c,0);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      Q(p,c*2+1,0) -= Ul(p,c,0);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">// compute the ratios of positive and negative element contributions that</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">// ensure monotonicity (Lohner: R^{+,-})</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">for</span> (std::size_t p=0; p&lt;P.nunk(); ++p)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      Q(p,c*2+0,0) =</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        (P(p,c*2+0,0) &gt; 0.0 ? <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>(1.0,Q(p,c*2+0,0)/P(p,c*2+0,0)) : 0.0);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      Q(p,c*2+1,0) =</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        (P(p,c*2+1,0) &lt; 0.0 ? <a class="code" href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">std::min</a>(1.0,Q(p,c*2+1,0)/P(p,c*2+1,0)) : 0.0);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// calculate limit coefficient for all elements (Lohner: C_el)</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  tk::Fields C( inpoel.size()/4, ncomp );</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      std::array&lt; tk::real, 4 &gt; R;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        R[j] = <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+j,c,0) &gt; 0.0 ? Q(N[j],c*2+0,0) : Q(N[j],c*2+1,0);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      C(e,c,0) = *std::min_element( begin(R), end(R) );</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( C(e,c,0) &gt; -std::numeric_limits&lt; tk::real &gt;::epsilon() &amp;&amp;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;              C(e,c,0) &lt; 1.0+std::numeric_limits&lt; tk::real &gt;::epsilon(),</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;              <span class="stringliteral">&quot;0 &lt;= AEC &lt;= 1.0 failed&quot;</span> );</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">// save the limited antidiffusive element contributions (Lohner: AEC^c)</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// access pointer to solution at element nodes</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    std::vector&lt; const tk::real* &gt; a( ncomp );</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) a[c] = A.cptr( c, 0 );</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// scatter-add limited antidiffusive element contributions to nodes</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) </div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        A.var(a[c],N[j]) += C(e,c,0) * <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+j,c,0);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div><div class="ttc" id="namespacetk_html_afd730d099e698f124362ef8c01483e0f"><div class="ttname"><a href="namespacetk.html#afd730d099e698f124362ef8c01483e0f">tk::min</a></div><div class="ttdeci">Data&lt; Layout &gt; min(const Data&lt; Layout &gt; &amp;a, const Data&lt; Layout &gt; &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00561">Data.h:561</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a5ed244339a9816df09d82a4ce620b5dd"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">inciter::FluxCorrector::m_aec</a></div><div class="ttdeci">tk::Fields m_aec</div><div class="ttdoc">Antidiffusive element contributions for all scalar components. </div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00096">FluxCorrector.h:96</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00093">FluxCorrector.h:93</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00049">Control.h:49</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00118">Tags.h:118</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00049">Exception.h:49</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_carrier_8_c_source.html#l00043">Carrier.C:43</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_ad43e70b5ccda36f0d541e674404236ed_cgraph.svg" width="518" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7a12b63e7d9a0ecd8baaf4d102746919"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tk::Fields FluxCorrector::lump </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; std::vector&lt; <a class="el" href="namespacetk.html#a1a96ada94b7e2911ecca0a360f305575">tk::real</a> &gt;, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute lumped mass matrix lhs for low order system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coord</td><td>Mesh node coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Lumped mass matrix </dd></dl>
<dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00192">192</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p>References <a class="el" href="_carrier_8_c_source.html#l00043">inciter::g_inputdeck</a>, <a class="el" href="_control_8h_source.html#l00049">tk::Control&lt; Ts &gt;::get()</a>, and <a class="el" href="_vector_8h_source.html#l00067">tk::triple()</a>.</p>

<p>Referenced by <a class="el" href="_flux_corrector_8h_source.html#l00039">FluxCorrector()</a>, and <a class="el" href="_carrier_8_c_source.html#l00535">inciter::Carrier::lhs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; x = coord[0];</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; y = coord[1];</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; z = coord[2];</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  tk::Fields L( coord[0].size(), ncomp );</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  L.fill( 0.0 );</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                           inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// compute element Jacobi determinant</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">const</span> std::array&lt; tk::real, 3 &gt;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      ba{{ x[N[1]]-x[N[0]], y[N[1]]-y[N[0]], z[N[1]]-z[N[0]] }},</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      ca{{ x[N[2]]-x[N[0]], y[N[2]]-y[N[0]], z[N[2]]-z[N[0]] }},</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      da{{ x[N[3]]-x[N[0]], y[N[3]]-y[N[0]], z[N[3]]-z[N[0]] }};</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> J = <a class="code" href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a>( ba, ca, da ) * 5.0 / 120.0;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// access pointer to lumped mass left hand side at element nodes</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    std::vector&lt; const tk::real* &gt; l( ncomp );</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) l[c] = L.cptr( c, 0 );</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// scatter-add lumped mass element contributions to lhs nodes</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        L.var(l[c],N[j]) += J;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">return</span> L;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div><div class="ttc" id="namespacetk_html_ae5b04b00aa51667b944b7188545ec5ae"><div class="ttname"><a href="namespacetk.html#ae5b04b00aa51667b944b7188545ec5ae">tk::triple</a></div><div class="ttdeci">T triple(const std::array&lt; T, 3 &gt; &amp;v1, const std::array&lt; T, 3 &gt; &amp;v2, const std::array&lt; T, 3 &gt; &amp;v3)</div><div class="ttdef"><b>Definition:</b> <a href="_vector_8h_source.html#l00067">Vector.h:67</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00093">FluxCorrector.h:93</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00049">Control.h:49</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00118">Tags.h:118</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_carrier_8_c_source.html#l00043">Carrier.C:43</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_a7a12b63e7d9a0ecd8baaf4d102746919_cgraph.svg" width="451" height="110"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a63a87d4dff620c6f905f0403ed0b1764"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void inciter::FluxCorrector::pup </td>
          <td>(</td>
          <td class="paramtype">PUP::er &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack/Unpack serialize member function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>Charm++'s PUP::er serializer object reference </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00082">82</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>

<p>References <a class="el" href="_flux_corrector_8h_source.html#l00096">m_aec</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                         {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      p | <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div><div class="ttc" id="classinciter_1_1_flux_corrector_html_a5ed244339a9816df09d82a4ce620b5dd"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">inciter::FluxCorrector::m_aec</a></div><div class="ttdeci">tk::Fields m_aec</div><div class="ttdoc">Antidiffusive element contributions for all scalar components. </div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00096">FluxCorrector.h:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6c1ccc3be523b160364780732f780230"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FluxCorrector::verify </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>nchare</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>inpoel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>dUh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tk::Fields &amp;&#160;</td>
          <td class="paramname"><em>dUl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify the assembled antidiffusive element contributions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nchare</td><td>Total number of host chares </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inpoel</td><td>Mesh element connectivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dUh</td><td>Increment of the high order solution </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dUl</td><td>Increment of the low order solution </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if verification has been done</dd></dl>
<p>This verification only makes sense if no communication is to be done, i.e., if there is a single host chare, because the AEC assembled to mesh nodes only contains partial contributions on chare boundaries at this point. Verification in parallel would incure communication of the unlimited AEC, which in general is not necessary, so we will not do that for the sake of verification. </p><dl class="section note"><dt>Note</dt><dd>This function is optimized away in RELEASE mode, see <a class="el" href="carrier_8ci.html">carrier.ci</a> and <a class="el" href="classinciter_1_1_carrier.html#a751ddcb0178069d26659b9cc64ee4adf" title="Verify antidiffusive element contributions up to linear solver convergence. ">Carrier::verify()</a>. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_flux_corrector_8_c_source.html#l00131">131</a> of file <a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a>.</p>

<p>References <a class="el" href="_exception_8h_source.html#l00049">Assert</a>, <a class="el" href="_carrier_8_c_source.html#l00043">inciter::g_inputdeck</a>, <a class="el" href="_control_8h_source.html#l00049">tk::Control&lt; Ts &gt;::get()</a>, <a class="el" href="_flux_corrector_8h_source.html#l00096">m_aec</a>, <a class="el" href="_data_8h_source.html#l00632">tk::maxdiff()</a>, and <a class="el" href="_exception_8h_source.html#l00034">Throw</a>.</p>

<p>Referenced by <a class="el" href="_flux_corrector_8h_source.html#l00039">FluxCorrector()</a>, and <a class="el" href="_carrier_8_c_source.html#l01020">inciter::Carrier::verify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a>( dUl.nunk() == dUh.nunk() &amp;&amp; dUl.nprop() == dUh.nprop(),</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="stringliteral">&quot;Unknown array size mismatch&quot;</span> );</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">if</span> (nchare == 1) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keyword">auto</span> ncomp = <a class="code" href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">g_inputdeck</a>.<a class="code" href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">get</a>&lt; <a class="code" href="structtag_1_1component.html">tag::component</a> &gt;().nprop();</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    tk::Fields U( dUh.nunk(), dUh.nprop() );</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    U.fill( 0.0 );</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">for</span> (std::size_t e=0; e&lt;inpoel.size()/4; ++e) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keyword">const</span> std::array&lt; std::size_t, 4 &gt; N{{ inpoel[e*4+0], inpoel[e*4+1],</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                             inpoel[e*4+2], inpoel[e*4+3] }};</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">// access pointer to solution at element nodes</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      std::vector&lt; const tk::real* &gt; u( ncomp );</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) u[c] = U.cptr( c, 0 );</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="comment">// scatter-add antidiffusive element contributions to nodes</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">ncomp_t</a> c=0; c&lt;ncomp; ++c) </div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">for</span> (std::size_t j=0; j&lt;4; ++j)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          U.var(u[c],N[j]) += <a class="code" href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">m_aec</a>(e*4+j,c,0);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// Compute maximum difference between the assembled AEC and dUh-dUl</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keyword">auto</span> d = <a class="code" href="namespacetk.html#ab7f02155bc2945a0a0c82c1be5cad041">tk::maxdiff</a>( U, dUh-dUl );</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// Tolerance: 10 x the linear solver tolerance for the high order solution.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (d.second &gt; 1.0e-7) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;maxdiff at &quot;</span> &lt;&lt; d.first &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; d.second</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, dUh:&quot;</span> &lt;&lt; dUh(d.first,0,0) &lt;&lt; <span class="stringliteral">&quot;, dUl:&quot;</span> &lt;&lt; dUl(d.first,0,0)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, dUh-dUl:&quot;</span> &lt;&lt; dUh(d.first,0,0) - dUl(d.first,0,0)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, AEC:&quot;</span> &lt;&lt; U(d.first,0,0) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <a class="code" href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a>( <span class="stringliteral">&quot;Assembled AEC does not equal dUh-dUl&quot;</span> );</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div><div class="ttc" id="_exception_8h_html_a0412f798470c18f503a2c2f63c970ba8"><div class="ttname"><a href="_exception_8h.html#a0412f798470c18f503a2c2f63c970ba8">Throw</a></div><div class="ttdeci">#define Throw(...)</div><div class="ttdoc">Throw macro that always throws an exception. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00034">Exception.h:34</a></div></div>
<div class="ttc" id="namespacetk_html_ab7f02155bc2945a0a0c82c1be5cad041"><div class="ttname"><a href="namespacetk.html#ab7f02155bc2945a0a0c82c1be5cad041">tk::maxdiff</a></div><div class="ttdeci">std::pair&lt; std::size_t, tk::real &gt; maxdiff(const Data&lt; Layout &gt; &amp;lhs, const Data&lt; Layout &gt; &amp;rhs)</div><div class="ttdef"><b>Definition:</b> <a href="_data_8h_source.html#l00632">Data.h:632</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a5ed244339a9816df09d82a4ce620b5dd"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a5ed244339a9816df09d82a4ce620b5dd">inciter::FluxCorrector::m_aec</a></div><div class="ttdeci">tk::Fields m_aec</div><div class="ttdoc">Antidiffusive element contributions for all scalar components. </div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00096">FluxCorrector.h:96</a></div></div>
<div class="ttc" id="classinciter_1_1_flux_corrector_html_a1281f06d84581b1b5a527a8ad975c2f4"><div class="ttname"><a href="classinciter_1_1_flux_corrector.html#a1281f06d84581b1b5a527a8ad975c2f4">inciter::FluxCorrector::ncomp_t</a></div><div class="ttdeci">kw::ncomp::info::expect::type ncomp_t</div><div class="ttdef"><b>Definition:</b> <a href="_flux_corrector_8h_source.html#l00093">FluxCorrector.h:93</a></div></div>
<div class="ttc" id="classtk_1_1_control_html_a85c14acef1b9de96946fcf2ab7c08721"><div class="ttname"><a href="classtk_1_1_control.html#a85c14acef1b9de96946fcf2ab7c08721">tk::Control::get</a></div><div class="ttdeci">constexpr const Tuple::template nT&lt; tag &gt; &amp; get() const noexcept</div><div class="ttdoc">Const-ref accessor to single element at 1st level. </div><div class="ttdef"><b>Definition:</b> <a href="_control_8h_source.html#l00049">Control.h:49</a></div></div>
<div class="ttc" id="structtag_1_1component_html"><div class="ttname"><a href="structtag_1_1component.html">tag::component</a></div><div class="ttdef"><b>Definition:</b> <a href="_tags_8h_source.html#l00118">Tags.h:118</a></div></div>
<div class="ttc" id="_exception_8h_html_a6e509ba096551a0924ec024afadba810"><div class="ttname"><a href="_exception_8h.html#a6e509ba096551a0924ec024afadba810">Assert</a></div><div class="ttdeci">#define Assert(expr,...)</div><div class="ttdoc">Assert macro that only throws an exception if expr fails. </div><div class="ttdef"><b>Definition:</b> <a href="_exception_8h_source.html#l00049">Exception.h:49</a></div></div>
<div class="ttc" id="namespaceinciter_html_a090ec6ca70e71bf204aa6ed5295bcaf3"><div class="ttname"><a href="namespaceinciter.html#a090ec6ca70e71bf204aa6ed5295bcaf3">inciter::g_inputdeck</a></div><div class="ttdeci">ctr::InputDeck g_inputdeck</div><div class="ttdef"><b>Definition:</b> <a href="_carrier_8_c_source.html#l00043">Carrier.C:43</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classinciter_1_1_flux_corrector_a6c1ccc3be523b160364780732f780230_cgraph.svg" width="492" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a3a6560d181de19a2239836c77efc2353"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void operator| </td>
          <td>(</td>
          <td class="paramtype">PUP::er &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classinciter_1_1_flux_corrector.html">FluxCorrector</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack/Unpack serialize operator|. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>Charm++'s PUP::er serializer object reference </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">i</td><td><a class="el" href="classinciter_1_1_flux_corrector.html">FluxCorrector</a> object reference </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>J. Bakosi </dd></dl>

<p>Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00089">89</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{ i.pup(p); }</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a5ed244339a9816df09d82a4ce620b5dd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tk::Fields inciter::FluxCorrector::m_aec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Antidiffusive element contributions for all scalar components. </p>

<p>Definition at line <a class="el" href="_flux_corrector_8h_source.html#l00096">96</a> of file <a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a>.</p>

<p>Referenced by <a class="el" href="_flux_corrector_8_c_source.html#l00027">aec()</a>, <a class="el" href="_flux_corrector_8_c_source.html#l00344">lim()</a>, <a class="el" href="_flux_corrector_8h_source.html#l00082">pup()</a>, and <a class="el" href="_flux_corrector_8_c_source.html#l00131">verify()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/tmp/q/quinoa/src/Inciter/<a class="el" href="_flux_corrector_8h_source.html">FluxCorrector.h</a></li>
<li>/tmp/q/quinoa/src/Inciter/<a class="el" href="_flux_corrector_8_c_source.html">FluxCorrector.C</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceinciter.html">inciter</a></li><li class="navelem"><a class="el" href="classinciter_1_1_flux_corrector.html">FluxCorrector</a></li>
    <li class="footer">Generated on Sat Oct 15 2016 04:42:19 for Quinoa by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
